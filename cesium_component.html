<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Cesium Globe</title>
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.113/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.113/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
      html, body, #cesiumContainer {
        width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div id="cesiumContainer"></div>
    <script>
      Cesium.Ion.defaultAccessToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyYmZjMGU3OS0wYjE5LTQwYzItYThmNC04Y2NlODZjYTA1ZjciLCJpZCI6MzUwNjQ1LCJpYXQiOjE3NjA1MDg3NDB9.m3BFiquwA4LnItl6sBbr-vr1RXhQGu65NMx6g5MiUGs";

      const viewer = new Cesium.Viewer('cesiumContainer', {
        timeline: false,
        animation: false,
        baseLayerPicker: true
      });

      // Listen for incoming points from Streamlit
      window.addEventListener('message', (event) => {
        if (event.data.type === 'addPoints') {
          viewer.entities.removeAll();
          event.data.points.forEach(p => {
            const entity = viewer.entities.add({
              position: Cesium.Cartesian3.fromDegrees(p.lon, p.lat),
              point: { pixelSize: 10, color: Cesium.Color.RED },
              description: `<h3>${p.title}</h3><p>${p.location}</p>`
            });
          });
          viewer.flyTo(viewer.entities);
        }
      });
    </script>
  </body>
</html>

